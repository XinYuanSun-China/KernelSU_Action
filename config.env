CONFIG_ENV=config.env

# 核心内核源码配置（修复原地址错误+适配小米9）
KERNEL_SOURCE=https://github.com/MiCode/Xiaomi_Kernel_OpenSource.git  # 去掉/tree/，改为git仓库地址
KERNEL_SOURCE_BRANCH=cepheus-p-oss  # 小米9官方内核分支（4.14，若要5.10+需替换为5.10 GKI源码分支）
KERNEL_CONFIG=vendor/cepheus_defconfig  # 替换wayne（小米6X）为cepheus（小米9）的配置文件
KERNEL_IMAGE_NAME=Image.gz-dtb  # 小米9内核镜像名，无需改
ARCH=arm64  # 小米9是arm64架构，无需改
ADD_LOCALVERSION_TO_FILENAME=false
EXTRA_CMDS="LD=ld.lld"  # 修复语法：冒号改等号+加引号，适配编译链接器

# Clang 编译器配置（适配小米9内核编译）
## Custom
USE_CUSTOM_CLANG=false
CUSTOM_CLANG_SOURCE=
CUSTOM_CLANG_BRANCH=

### if your set USE CUSTOM CLANG to false than DO NOT CHANGE CUSTOM CMDS
CUSTOM_CMDS:CLANG_TRIPLE=aarch64-linux-gnu-

## AOSP
CLANG_BRANCH=master-kernel-build-2022
CLANG_VERSION=r487747b  # 升级为适配Android 15/5.10内核的clang版本（原r450784e偏旧）

# GCC 配置（保持启用，小米9内核编译依赖）
ENABLE_GCC_ARM64=true
ENABLE_GCC_ARM32=true
USE_CUSTOM_GCC_64=false
CUSTOM_GCC_64_SOURCE=
CUSTOM_GCC_64_BRANCH=
CUSTOM_GCC_64_BIN=aarch64-linux-android-
USE_CUSTOM_GCC_32=false
CUSTOM_GCC_32_SOURCE=
CUSTOM_GCC_32_BRANCH=
CUSTOM_GCC_32_BIN=arm-linux-androideabi-

# KernelSU 配置（启用Root，关键！）
ENABLE_KERNELSU=true  # 改为true，启用KernelSU
KERNELSU_TAG=v0.9.5  # 适配非GKI内核的最后稳定版
KSU_EXPECTED_SIZE=0x033b  # 填官方默认值，否则KernelSU管理器识别失败
KSU_EXPECTED_HASH=c371061b19d8c7d7d6133c6a9bafe198fa944e50c1b31c9d8daa8d7f1fc2d2d6  # 官方默认值

# 编译配置（修复语法+适配KernelSU）
DISABLE_LTO=false  # 修复语法：横杠改下划线（原DISABLE-LTO脚本识别不到）
DISABLE_CC_WERROR=true  # 改为true，避免编译警告导致失败
ADD_KPROBES_CONFIG=true  # 改为true，为KernelSU提供调试支持
ADD_OVERLAYFS_CONFIG=true  # 改为true，支持KernelSU的文件系统叠加
APPLY_KSU_PATCH=true  # 改为true，自动应用KernelSU补丁
REMOVE_UNUSED_PACKAGES=true

# AnyKernel3 配置（编译后生成可刷入的zip包）
## AnyKernel3 Custom
USE_CUSTOM_ANYKERNEL3=false
CUSTOM_ANYKERNEL3_SOURCE=
CUSTOM_ANYKERNEL3_BRANCH=

# 编译缓存（加速重复编译）
ENABLE_CCACHE=true

# DTBO 镜像（小米9无需单独编译）
NEED_DTBO=false

# 构建完整boot.img（关键！小米9需要这个才能开机）
BUILD_BOOT_IMG=true  # 改为true，否则只编译内核不打包成boot.img
SOURCE_BOOT_IMAGE=https://www.haioukc.com/api/filetransfer/downloadfile?userFileId=2004167329325301760&shareBatchNum=884f97f11890488f936e1b7cca4406e4&extractionCode=108524&passCode=&currentDownloadKey=1184c824e36f46c892ed556e17bd9361  # 替换为你备份的小米9正常开机的boot.img直链
